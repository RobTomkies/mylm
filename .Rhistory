mci <- function(N, niter){
p <- rep(NA,niter) #create a null vector for storing the estimates
for (i in 1:niter){
zvec <- rchisq(N, df = 20, ncp = 0) #at each iteration i generate N values of z-N(0,1)
p[i] <- length(zvec[zvec<9])/N #calculate proportion of Z <9
}
summ.p <- list(mean(p), var(p))
names(summ.p) <- c('mean(p)','var(p)')
return(summ.p)
}
mci(1000,100) #obtain 100 estimates using 1000 values of z each time
impsampling <- function(N,niter){
p <- rep(NA,niter) #create a null vector for storing the estimate
for (i in 1:niter){
zvec<- rchisq(N, df = 6, ncp = 0)
h <- zvec<9 #create a logical vector: 1(TRUE) if z<9, 0 (FALSE) otherwise
w <- (1/(8192*gamma(10)*gamma(3)))*zvec^7 #calculate weights
p[i] <- sum(w*h)/N #calculate estimates as weighted average of h(z)
}
summ.p <- list(mean(p),var(p)) #calculate average and variance of estimates
names(summ.p) <- c("mean(p)","var(p)")
return(summ.p)
}
impsampling(1000,100) #obtain 100 estimates using 1000 values of z each time
# importance sampling
normalMCI <- 0
importance_sampling_est <- 0
nsamplevec <- 200*(1:30)
set.seed(4)
for (i in 1:30){
nsamples <- nsamplevec[i]
truesamples <- rgamma(nsamples,3,1)
normalMCI[i] <- sum(truesamples>9)/nsamples
#part 1
normsamples <- rnorm(nsamples,9,1)
weights <- sqrt(pi/2)*normsamples^2*exp(-normsamples)/exp(-(normsamples-9)^2/2)
importance_sampling_est[i] <- sum(weights[normsamples>9])/nsamples
# part 2
expsamples <- 9+rexp(nsamples)
weights <- expsamples^2/(2*exp(9))
importance_sampling_est[i] <- sum(weights[expsamples>9])/nsamples
}
answer <- 1-pgamma(9,3,1)
plot(nsamplevec,normalMCI,type="l",col="black",lwd=2, ylab="Estimates",xlab="Sample Size")
lines(nsamplevec,importance_sampling_est,lty=1,col="navyblue", lwd=3)
lines(c(0,max(nsamplevec)),c(answer,answer),col='darkred', lwd=2, lty=2)
legend("topright",legend=c("Normal MCI","Imp. Samp.","Exact"),lty=c(1,1,1),col=c("black","red","blue"))
#part 1
?rnorm
?rgamma
normalMCI <- 0
importance_sampling_est <- 0
nsamplevec <- 200*(1:30)
set.seed(4)
for (i in 1:30){
nsamples <- nsamplevec[i]
truesamples <- rchisq(nsamples, df = 20, ncp = 0)
normalMCI[i] <- sum(truesamples<9)/nsamples
#part 1
normsamples <- zvec<- rchisq(N, df = 6, ncp = 0)
weights <- (1/(8192*gamma(10)*gamma(3)))*x^7
importance_sampling_est[i] <- sum(weights[normsamples<9])/nsamples
# # part 2
# expsamples <- 9+rexp(nsamples)
# weights <- expsamples^2/(2*exp(9))
# importance_sampling_est[i] <- sum(weights[expsamples>9])/nsamples
}
normalMCI <- 0
importance_sampling_est <- 0
nsamplevec <- 200*(1:30)
set.seed(4)
for (i in 1:30){
nsamples <- nsamplevec[i]
truesamples <- rchisq(nsamples, df = 20, ncp = 0)
normalMCI[i] <- sum(truesamples<9)/nsamples
#part 1
normsamples <- rchisq(N, df = 6, ncp = 0)
weights <- (1/(8192*gamma(10)*gamma(3)))*x^7
importance_sampling_est[i] <- sum(weights[normsamples<9])/nsamples
# # part 2
# expsamples <- 9+rexp(nsamples)
# weights <- expsamples^2/(2*exp(9))
# importance_sampling_est[i] <- sum(weights[expsamples>9])/nsamples
}
normalMCI <- 0
importance_sampling_est <- 0
nsamplevec <- 200*(1:30)
set.seed(4)
for (i in 1:30){
nsamples <- nsamplevec[i]
truesamples <- rchisq(nsamples, df = 20, ncp = 0)
normalMCI[i] <- sum(truesamples<9)/nsamples
#part 1
normsamples <- rchisq(nsamples, df = 6, ncp = 0)
weights <- (1/(8192*gamma(10)*gamma(3)))*x^7
importance_sampling_est[i] <- sum(weights[normsamples<9])/nsamples
# # part 2
# expsamples <- 9+rexp(nsamples)
# weights <- expsamples^2/(2*exp(9))
# importance_sampling_est[i] <- sum(weights[expsamples>9])/nsamples
}
plot(nsamplevec,normalMCI,type="l",col="black",lwd=2, ylab="Estimates",xlab="Sample Size")
lines(nsamplevec,importance_sampling_est,lty=1,col="navyblue", lwd=3)
normalMCI <- 0
importance_sampling_est <- 0
nsamplevec <- 200*(1:30)
set.seed(4)
for (i in 1:30){
nsamples <- nsamplevec[i]
truesamples <- rchisq(nsamples, df = 20, ncp = 0)
normalMCI[i] <- sum(truesamples<9)/nsamples
#part 1
normsamples <- rchisq(nsamples, df = 6, ncp = 0)
weights <- (9/(1024*gamma(10)))*normsamples^9*e^(normsamples/2)
importance_sampling_est[i] <- sum(weights[normsamples<9])/nsamples
# # part 2
# expsamples <- 9+rexp(nsamples)
# weights <- expsamples^2/(2*exp(9))
# importance_sampling_est[i] <- sum(weights[expsamples>9])/nsamples
}
normalMCI <- 0
importance_sampling_est <- 0
nsamplevec <- 200*(1:30)
set.seed(4)
for (i in 1:30){
nsamples <- nsamplevec[i]
truesamples <- rchisq(nsamples, df = 20, ncp = 0)
normalMCI[i] <- sum(truesamples<9)/nsamples
#part 1
normsamples <- rchisq(nsamples, df = 6, ncp = 0)
weights <- (9/(1024*gamma(10)))*normsamples^9*exp(normsamples/2)
importance_sampling_est[i] <- sum(weights[normsamples<9])/nsamples
# # part 2
# expsamples <- 9+rexp(nsamples)
# weights <- expsamples^2/(2*exp(9))
# importance_sampling_est[i] <- sum(weights[expsamples>9])/nsamples
}
plot(nsamplevec,normalMCI,type="l",col="black",lwd=2, ylab="Estimates",xlab="Sample Size")
lines(nsamplevec,importance_sampling_est,lty=1,col="navyblue", lwd=3)
#part 1
?runif
normalMCI <- 0
importance_sampling_est <- 0
nsamplevec <- 200*(1:30)
set.seed(4)
for (i in 1:30){
nsamples <- nsamplevec[i]
truesamples <- rchisq(nsamples, df = 20, ncp = 0)
normalMCI[i] <- sum(truesamples<9)/nsamples
#part 1
normsamples <- runif(nsamples, min =  0, max = 9)
weights <- (9/(1024*gamma(10)))*normsamples^9*exp(normsamples/2)
importance_sampling_est[i] <- sum(weights[normsamples<9])/nsamples
# # part 2
# expsamples <- 9+rexp(nsamples)
# weights <- expsamples^2/(2*exp(9))
# importance_sampling_est[i] <- sum(weights[expsamples>9])/nsamples
}
plot(nsamplevec,normalMCI,type="l",col="black",lwd=2, ylab="Estimates",xlab="Sample Size")
lines(nsamplevec,importance_sampling_est,lty=1,col="navyblue", lwd=3)
normalMCI <- 0
importance_sampling_est <- 0
nsamplevec <- 200*(1:30)
set.seed(4)
for (i in 1:30){
nsamples <- nsamplevec[i]
truesamples <- rchisq(nsamples, df = 20, ncp = 0)
normalMCI[i] <- sum(truesamples<9)/nsamples
#part 1
normsamples <- runif(nsamples, min =  0, max = 10)
weights <- (10/(1024*gamma(10)))*normsamples^9*exp(normsamples/2)
importance_sampling_est[i] <- sum(weights[normsamples<9])/nsamples
# # part 2
# expsamples <- 9+rexp(nsamples)
# weights <- expsamples^2/(2*exp(9))
# importance_sampling_est[i] <- sum(weights[expsamples>9])/nsamples
}
plot(nsamplevec,normalMCI,type="l",col="black",lwd=2, ylab="Estimates",xlab="Sample Size")
lines(nsamplevec,importance_sampling_est,lty=1,col="navyblue", lwd=3)
nsamplevec
importance_sampling_est
normalMCI <- 0
importance_sampling_est <- 0
nsamplevec <- 200*(1:30)
set.seed(4)
for (i in 1:30){
nsamples <- nsamplevec[i]
truesamples <- rchisq(nsamples, df = 20, ncp = 0)
normalMCI[i] <- sum(truesamples<9)/nsamples
#part 1
normsamples <- runif(nsamples, min =  0, max = 10)
weights <- (10/(1024*gamma(10)))*normsamples^9*exp(normsamples/2)
importance_sampling_est[i] <- sum(weights[normsamples<9])/nsamples
# # part 2
# expsamples <- 9+rexp(nsamples)
# weights <- expsamples^2/(2*exp(9))
# importance_sampling_est[i] <- sum(weights[expsamples>9])/nsamples
}
plot(nsamplevec,normalMCI,type="l",col="black",lwd=2, ylab="Estimates",xlab="Sample Size")
lines(nsamplevec,importance_sampling_est,lty=1,col="navyblue", lwd=3)
normalMCI <- 0
importance_sampling_est <- 0
nsamplevec <- 200*(1:30)
set.seed(4)
for (i in 1:30){
nsamples <- nsamplevec[i]
truesamples <- rchisq(nsamples, df = 20, ncp = 0)
normalMCI[i] <- sum(truesamples<9)/nsamples
#part 1
normsamples <- runif(nsamples, min =  0, max = 9)
weights <- (9/(1024*gamma(10)))*normsamples^9*exp(normsamples/2)
importance_sampling_est[i] <- sum(weights[normsamples<9])/nsamples
# # part 2
# expsamples <- 9+rexp(nsamples)
# weights <- expsamples^2/(2*exp(9))
# importance_sampling_est[i] <- sum(weights[expsamples>9])/nsamples
}
plot(nsamplevec,normalMCI,type="l",col="black",lwd=2, ylab="Estimates",xlab="Sample Size")
lines(nsamplevec,importance_sampling_est,lty=1,col="navyblue", lwd=3)
normalMCI <- 0
importance_sampling_est <- 0
nsamplevec <- 200*(1:30)
set.seed(4)
for (i in 1:30){
nsamples <- nsamplevec[i]
truesamples <- rchisq(nsamples, df = 20, ncp = 0)
normalMCI[i] <- sum(truesamples<9)/nsamples
#part 1
normsamples <- runif(nsamples, min =  0, max = 9)
weights <- (1/(1024*normsamples*gamma(10)))*normsamples^9*exp(normsamples/2)
importance_sampling_est[i] <- sum(weights[normsamples<9])/nsamples
# # part 2
# expsamples <- 9+rexp(nsamples)
# weights <- expsamples^2/(2*exp(9))
# importance_sampling_est[i] <- sum(weights[expsamples>9])/nsamples
}
plot(nsamplevec,normalMCI,type="l",col="black",lwd=2, ylab="Estimates",xlab="Sample Size")
lines(nsamplevec,importance_sampling_est,lty=1,col="navyblue", lwd=3)
normalMCI <- 0
importance_sampling_est <- 0
nsamplevec <- 200*(1:30)
set.seed(4)
for (i in 1:30){
nsamples <- nsamplevec[i]
truesamples <- rchisq(nsamples, df = 20, ncp = 0)
normalMCI[i] <- sum(truesamples<9)/nsamples
#part 1
normsamples <- rchisq(nsamples, df = 20, ncp = 0)
weights <- (1/(1024*gamma(10)))*normsamples^9*exp(normsamples/2)
importance_sampling_est[i] <- sum(weights[normsamples<9])/nsamples
# # part 2
# expsamples <- 9+rexp(nsamples)
# weights <- expsamples^2/(2*exp(9))
# importance_sampling_est[i] <- sum(weights[expsamples>9])/nsamples
}
plot(nsamplevec,normalMCI,type="l",col="black",lwd=2, ylab="Estimates",xlab="Sample Size")
lines(nsamplevec,importance_sampling_est,lty=1,col="navyblue", lwd=3)
normalMCI <- 0
importance_sampling_est <- 0
nsamplevec <- 200*(1:30)
set.seed(4)
for (i in 1:30){
nsamples <- nsamplevec[i]
truesamples <- rchisq(nsamples, df = 20, ncp = 0)
normalMCI[i] <- sum(truesamples<9)/nsamples
#part 1
normsamples <- rchisq(nsamples, df = 20, ncp = 0)
weights <- (1/(8192*gamma(10)*gamma(3)))*normsamples^7
importance_sampling_est[i] <- sum(weights[normsamples<9])/nsamples
# # part 2
# expsamples <- 9+rexp(nsamples)
# weights <- expsamples^2/(2*exp(9))
# importance_sampling_est[i] <- sum(weights[expsamples>9])/nsamples
}
plot(nsamplevec,normalMCI,type="l",col="black",lwd=2, ylab="Estimates",xlab="Sample Size")
lines(nsamplevec,importance_sampling_est,lty=1,col="navyblue", lwd=3)
importance_sampling_est
impsampling <- function(N,niter){
p <- rep(NA,niter) #create a null vector for storing the estimate
for (i in 1:niter){
zvec<- rchisq(N, df = 20, ncp = 0)
h <- zvec<9 #create a logical vector: 1(TRUE) if z<9, 0 (FALSE) otherwise
w <- (1/(8192*gamma(10)*gamma(3)))*zvec^7 #calculate weights
p[i] <- sum(w*h)/N #calculate estimates as weighted average of h(z)
}
summ.p <- list(mean(p),var(p)) #calculate average and variance of estimates
names(summ.p) <- c("mean(p)","var(p)")
return(summ.p)
}
impsampling(1000,100) #obtain 100 estimates using 1000 values of z each time
impsampling <- function(N,niter){
p <- rep(NA,niter) #create a null vector for storing the estimate
for (i in 1:niter){
zvec<- rchisq(N, df = 6, ncp = 0)
h <- zvec<9 #create a logical vector: 1(TRUE) if z<9, 0 (FALSE) otherwise
w <- (1/(8192*gamma(10)*gamma(3)))*zvec^7 #calculate weights
p[i] <- sum(w*h)/N #calculate estimates as weighted average of h(z)
}
summ.p <- list(mean(p),var(p)) #calculate average and variance of estimates
names(summ.p) <- c("mean(p)","var(p)")
return(summ.p)
}
impsampling(1000,100) #obtain 100 estimates using 1000 values of z each time
impsampling <- function(N,niter){
p <- rep(NA,niter) #create a null vector for storing the estimate
for (i in 1:niter){
zvec<- rchisq(N, df = 6, ncp = 0)
h <- zvec<9 #create a logical vector: 1(TRUE) if z<9, 0 (FALSE) otherwise
#w <- (1/(8192*gamma(10)*gamma(3)))*zvec^7 #calculate weights
w <- (9/(1024)*gamma(10))*zvec^9*exp(-zvec/2)
p[i] <- sum(w*h)/N #calculate estimates as weighted average of h(z)
}
summ.p <- list(mean(p),var(p)) #calculate average and variance of estimates
names(summ.p) <- c("mean(p)","var(p)")
return(summ.p)
}
impsampling(1000,100) #obtain 100 estimates using 1000 values of z each time
impsampling <- function(N,niter){
p <- rep(NA,niter) #create a null vector for storing the estimate
for (i in 1:niter){
zvec<- rchisq(N, df = 6, ncp = 0)
h <- zvec<9 #create a logical vector: 1(TRUE) if z<9, 0 (FALSE) otherwise
#w <- (1/(8192*gamma(10)*gamma(3)))*zvec^7 #calculate weights
w <- (9/(1024*gamma(10)))*zvec^9*exp(-zvec/2)
p[i] <- sum(w*h)/N #calculate estimates as weighted average of h(z)
}
summ.p <- list(mean(p),var(p)) #calculate average and variance of estimates
names(summ.p) <- c("mean(p)","var(p)")
return(summ.p)
}
impsampling(1000,100) #obtain 100 estimates using 1000 values of z each time
impsampling <- function(N,niter){
p <- rep(NA,niter) #create a null vector for storing the estimate
for (i in 1:niter){
zvec<- rchisq(N, df = 6, ncp = 0)
h <- zvec<9 #create a logical vector: 1(TRUE) if z<9, 0 (FALSE) otherwise
#w <- (1/(8192*gamma(10)*gamma(3)))*zvec^7 #calculate weights
w <- (9/(1024*gamma(10)))*zvec^9*exp(-zvec/2)
p[i] <- sum(w*h)/N #calculate estimates as weighted average of h(z)
}
summ.p <- list(mean(p),var(p)) #calculate average and variance of estimates
names(summ.p) <- c("mean(p)","var(p)")
return(summ.p)
}
impsampling(1000,100) #obtain 100 estimates using 1000 values of z each time
impsampling <- function(N,niter){
p <- rep(NA,niter) #create a null vector for storing the estimate
for (i in 1:niter){
zvec<- rchisq(N, df = 6, ncp = 0)
h <- zvec<9 #create a logical vector: 1(TRUE) if z<9, 0 (FALSE) otherwise
#w <- (1/(8192*gamma(10)*gamma(3)))*zvec^7 #calculate weights
w <- (9/(1024*gamma(10)))*zvec^9*exp(-zvec/2)
p[i] <- sum(w*h)/N #calculate estimates as weighted average of h(z)
}
summ.p <- list(mean(p),var(p)) #calculate average and variance of estimates
names(summ.p) <- c("mean(p)","var(p)")
return(summ.p)
}
impsampling(1000,100) #obtain 100 estimates using 1000 values of z each time
normalMCI <- 0
importance_sampling_est <- 0
nsamplevec <- 200*(1:30)
set.seed(4)
for (i in 1:30){
nsamples <- nsamplevec[i]
truesamples <- rchisq(nsamples, df = 20, ncp = 0)
normalMCI[i] <- sum(truesamples<9)/nsamples
#part 1
normsamples <- runif(nsamples,min=0,max =9)
weights <- (1/(8192*gamma(10)*gamma(3)))*normsamples^7
importance_sampling_est[i] <- sum(weights[normsamples<9])/nsamples
# # part 2
# expsamples <- 9+rexp(nsamples)
# weights <- expsamples^2/(2*exp(9))
# importance_sampling_est[i] <- sum(weights[expsamples>9])/nsamples
}
plot(nsamplevec,normalMCI,type="l",col="black",lwd=2, ylab="Estimates",xlab="Sample Size")
lines(nsamplevec,importance_sampling_est,lty=1,col="navyblue", lwd=3)
mci <- function(N, niter){
p <- rep(NA,niter) #create a null vector for storing the estimates
for (i in 1:niter){
zvec <- rchisq(N, df = 20, ncp = 0) #at each iteration i generate N values of z-N(0,1)
p[i] <- length(zvec[zvec<9])/N #calculate proportion of Z <9
}
summ.p <- list(mean(p), var(p))
names(summ.p) <- c('mean(p)','var(p)')
return(summ.p)
}
mci(1000,100) #obtain 100 estimates using 1000 values of z each time
n <- 10-4
##Monte Carlo integration
z <- rchisq(n, df = 20, ncp = 0)
zind <- z<9
pmci <- cumsum(zind)/1:n
plot(pmci, type="l", xlab="Iteration", ylab="Estimate")
n <- 10^4
##Monte Carlo integration
z <- rchisq(n, df = 20, ncp = 0)
zind <- z<9
pmci <- cumsum(zind)/1:n
plot(pmci, type="l", xlab="Iteration", ylab="Estimate")
impsampling <- function(N,niter){
p <- rep(NA,niter) #create a null vector for storing the estimate
for (i in 1:niter){
zvec<- runif(N, min = 0, max = 9)
h <- zvec<9 #create a logical vector: 1(TRUE) if z<9, 0 (FALSE) otherwise
#w <- (1/(8192*gamma(10)*gamma(3)))*zvec^7 #calculate weights
w <- (9/(1024*gamma(10)))*zvec^9*exp(-zvec/2)
p[i] <- sum(w*h)/N #calculate estimates as weighted average of h(z)
}
summ.p <- list(mean(p),var(p)) #calculate average and variance of estimates
names(summ.p) <- c("mean(p)","var(p)")
return(summ.p)
}
impsampling(1000,100) #obtain 100 estimates using 1000 values of z each time
n <- 10^4
##Monte Carlo integration
z <- rchisq(n, df = 20, ncp = 0)
zind <- z<9
pmci <- cumsum(zind)/1:n
plot(pmci, type="l", xlab="Iteration", ylab="Estimate")
##Importance sampling
z <- runif(n,4,1)
h <- z<9
w <- (9/(1024*gamma(10)))*z^9*exp(-z/2)
pims <- cumsum(w*h)/1:n
lines(pims, col="gray", lwd=3)
abline(h=pnorm(3,lower.tail=F), lty=2, col="sienna")
n <- 10^4
##Monte Carlo integration
z <- rchisq(n, df = 20, ncp = 0)
zind <- z<9
pmci <- cumsum(zind)/1:n
plot(pmci, type="l", xlab="Iteration", ylab="Estimate")
##Importance sampling
z <- runif(n,0,9)
h <- z<9
w <- (9/(1024*gamma(10)))*z^9*exp(-z/2)
pims <- cumsum(w*h)/1:n
lines(pims, col="gray", lwd=3)
abline(h=pnorm(3,lower.tail=F), lty=2, col="sienna")
n <- 10^4
##Monte Carlo integration
z <- rchisq(n, df = 20, ncp = 0)
zind <- z<9
pmci <- cumsum(zind)/1:n
plot(pmci, type="l", xlab="Iteration", ylab="Estimate")
##Importance sampling
z <- runif(n,0,9)
h <- z<9
w <- (9/(1024*gamma(10)))*z^9*exp(-z/2)
pims <- cumsum(w*h)/1:n
lines(pims, col="gray", lwd=3)
abline(h=0.01698783, lty=2, col="sienna")
n <- 10^4
##Monte Carlo integration
z <- rchisq(n, df = 20, ncp = 0)
zind <- z<9
pmci <- cumsum(zind)/1:n
plot(pmci, type="l", xlab="Iteration", ylab="Estimate")
##Importance sampling
z <- runif(n,0,9)
h <- z<9
w <- (9/(1024*gamma(10)))*z^9*exp(-z/2)
pims <- cumsum(w*h)/1:n
lines(pims, col="gray", lwd=3)
n <- 10^4
##Monte Carlo integration
set.seed(0)
z <- rchisq(n, df = 20, ncp = 0)
zind <- z<9
pmci <- cumsum(zind)/1:n
plot(pmci, type="l", xlab="Iteration", ylab="Estimate")
##Importance sampling
set.seed(0)
z <- runif(n,0,9)
h <- z<9
w <- (9/(1024*gamma(10)))*z^9*exp(-z/2)
pims <- cumsum(w*h)/1:n
lines(pims, col="gray", lwd=3)
devtools::has_devel()
library(devtools)
getwd()
create_package("~/Documents/University lectures/Data501/AutoData/Auto_Data/Auto_data_package")
create_package("~/OneDrive/Documents/University lectures/Data501/AutoData/Auto_Data/Auto_data_package")
create_package("~/OneDrive/Documents/University lectures/Data501/AutoData/Auto_Data/AutoDataPackage")
setwd("~/University lectures/Data501/assignment2/mylm")
pacman::p_load(devtools)
load_all()
test()
mylm(fake.variable ~ Sepal.Length + Petal.Length, iris)
load_all()
test()
mylm(fake.variable ~ Sepal.Length + Petal.Length, iris)
load_all()
test()
mylm(fake.variable ~ Sepal.Length + Petal.Length, iris)
load_all()
test()
data(iris)
load_all()
test()
load_all()
test()
mylm(fake.variable ~ Sepal.Length + Petal.Length, iris)
load_all()
test()
load_all()
load_all()
test()
test_file("test-mylm.R")
test()
